<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../css/custom.css">
    <script src="https://cdn.jsdelivr.net/npm/p5@1.1.9/lib/p5.js" type="text/javascript"></script>

    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_SVG">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                processEscapes: true
            }
        });
    </script>

</head>
<body>


<script>
    var width = window.innerWidth;
    var height = window.innerHeight;

    var p = {}

    var margins = {
        "left": 5,
        "right": 5,
        "top": 10,
        "bottom": 10
    }

    var graph = d3.select("body").append("svg")
        .attr("preserveAspectRatio", "xMinYMin meet")
        .attr("viewBox", [0, 0, width, height])

    var zone_width = (width - margins.left - margins.right) / 4

    var xScale_1 = d3.scaleLinear()
        .domain([0, 1])
        .range([margins.left, zone_width + margins.left])
    var xScale_2 = d3.scaleLinear()
        .domain([0, 1])
        .range([zone_width + margins.left, 2 * zone_width + margins.left])
    var xScale_3 = d3.scaleLinear()
        .domain([0, 1])
        .range([2 * zone_width + margins.left, 3 * zone_width + margins.left])
    var xScale_4 = d3.scaleLinear()
        .domain([0, 1])
        .range([3 * zone_width + margins.left, 4 * zone_width + margins.left])

    var yScale = d3.scaleLinear()
        .domain([1, 0])
        .range([height - margins.bottom, margins.top])

    // graph.append("line")
    //     .attr("x1", xScale_1(0))
    //     .attr("y1", yScale(0.5))
    //     .attr("x2", xScale_4(1))
    //     .attr("y2", yScale(0.5))
    //     .attr("stroke", "red")
    //     .attr("stroke-width", 2)
    //
    // for (var i = 0; i < 5; i++) {
    //     graph.append("line")
    //         .attr("x1", margins.left + i * zone_width)
    //         .attr("y1", yScale(0))
    //         .attr("x2", margins.left + i * zone_width)
    //         .attr("y2", yScale(1))
    //         .attr("stroke", "red")
    //         .attr("stroke-width", 2)
    // }

    var g_level_1 = graph.append("g")
    var g_level_2 = graph.append("g")
    var g_level_3 = graph.append("g")
    var g_level_4 = graph.append("g")

    // ------------------ LEVEL 1 ------------------
    var box_size = yScale(0.25) - yScale(0);
    var radius = 10;


    g_level_1.append("rect")
        .attr("x", xScale_1(0.5) - box_size / 2)
        .attr("y", yScale(0.5) - box_size / 2)
        .attr("width", box_size)
        .attr("height", box_size)
        .attr("rx", 5)
        .style("fill", "#90bed0")
        .style("filter", "drop-shadow( 5px 5px 5px rgba(0, 0, 0, .7))");

    g_level_1.append("circle")
        .attr("cx", xScale_1(0.5) + box_size / 2)
        .attr("cy", yScale(0.5))
        .attr("r", radius)
        .attr("stroke", "none")
        .style("fill", "#90bed0")
    // .style("filter", "drop-shadow( 5px 5px 5px rgba(0, 0, 0, .7))");

    g_level_1.append("foreignObject")
        .attr("x", xScale_1(0.5) - box_size / 2)
        .attr("y", yScale(0.5) - box_size / 2)
        .attr("width", box_size)
        .attr("height", box_size)
        .append("xhtml:div")
        .html("<p style='text-align: center; font-size: 25px; font-family: sans-serif'>Physics <br/> & <br/>DL</p>")

    // ------------------ LEVEL 2 ------------------
    // two triangles
    g_level_2.append("polygon")
        .attr("points",
            (xScale_2(0.5) - box_size / 2) + "," + (yScale(0.25) - box_size / 2) + " " +
            (xScale_2(0.5) + box_size / 2) + "," + yScale(0.25) + " " +
            (xScale_2(0.5) - box_size / 2) + "," + (yScale(0.25) + box_size / 2))
        .style("fill", "#a0ce81")
        .style("filter", "drop-shadow( 5px 5px 5px rgba(0, 0, 0, .7))");

    g_level_2.append("polygon")
        .attr("points",
            (xScale_2(0.5) - box_size / 2) + "," + (yScale(0.75) - box_size / 2) + " " +
            (xScale_2(0.5) + box_size / 2) + "," + yScale(0.75) + " " +
            (xScale_2(0.5) - box_size / 2) + "," + (yScale(0.75) + box_size / 2))
        .style("fill", "#a0ce81")
        .style("filter", "drop-shadow( 5px 5px 5px rgba(0, 0, 0, .7))");

    // input and outputs circles
    g_level_2.append("circle")
        .attr("cx", xScale_2(0.5) - box_size / 2)
        .attr("cy", yScale(0.25))
        .attr("r", radius)
        .attr("stroke", "none")
        .style("fill", "#a0ce81")

    g_level_2.append("circle")
        .attr("cx", xScale_2(0.5) + box_size / 2)
        .attr("cy", yScale(0.25))
        .attr("r", radius)
        .attr("stroke", "none")
        .style("fill", "#a0ce81")

    g_level_2.append("circle")
        .attr("cx", xScale_2(0.5) - box_size / 2)
        .attr("cy", yScale(0.75))
        .attr("r", radius)
        .attr("stroke", "none")
        .style("fill", "#a0ce81")

    g_level_2.append("circle")
        .attr("cx", xScale_2(0.5) + box_size / 2)
        .attr("cy", yScale(0.75))
        .attr("r", radius)
        .attr("stroke", "none")
        .style("fill", "#a0ce81")

    g_level_2.append("text")
        .attr("x", xScale_2(0.5) - box_size / 2 + radius)
        .attr("y", yScale(0.25))
        .attr("text-anchor", "start")
        .attr("alignment-baseline", "middle")
        .style("fill", "black")
        .style("font-size", "20px")
        .style("font-family", "sans-serif")
        .text("Faster sim.");

    g_level_2.append("text")
        .attr("x", xScale_2(0.5) - box_size / 2 + radius)
        .attr("y", yScale(0.75))
        .attr("text-anchor", "start")
        .attr("alignment-baseline", "middle")
        .style("fill", "black")
        .style("font-size", "20px")
        .style("font-family", "sans-serif")
        .text("Robust sim.");

    // ------------------ LEVEL 3 ------------------

    var rect_width = box_size
    var rect_height = box_size * 0.3

    function draw_level3(x, y, text) {
        g_level_3.append("rect")
            .attr("x", xScale_3(x) - rect_width / 2)
            .attr("y", yScale(y) - rect_height / 2)
            .attr("width", rect_width)
            .attr("height", rect_height)
            .attr("rx", 5)
            .style("fill", "#f1a4a4")
            .style("filter", "drop-shadow( 5px 5px 5px rgba(0, 0, 0, .7))");

        g_level_3.append("circle")
            .attr("cx", xScale_3(x) + rect_width / 2)
            .attr("cy", yScale(y))
            .attr("r", radius)
            .attr("stroke", "none")
            .style("fill", "#f1a4a4")
        g_level_3.append("circle")
            .attr("cx", xScale_3(x) - rect_width / 2)
            .attr("cy", yScale(y))
            .attr("r", radius)
            .attr("stroke", "none")
            .style("fill", "#f1a4a4")

        g_level_3.append("text")
            .attr("x", xScale_3(x))
            .attr("y", yScale(y))
            .attr("text-anchor", "middle")
            .attr("alignment-baseline", "middle")
            .style("fill", "black")
            .style("font-size", "20px")
            .style("font-family", "sans-serif")
            .text(text);
    }

    draw_level3(0.5, 0.5, "More data");
    draw_level3(0.5, 0.25, "New models");
    draw_level3(0.5, 0.05, "Towards design");
    draw_level3(0.5, 0.75, "More hybrid");
    draw_level3(0.5, 0.95, "Towards control");

    var ico_size = box_size * 0.25
    g_level_3.append("foreignObject")
        .attr("x", xScale_3(0.5) - rect_width / 2)
        .attr("y", yScale(0.5) - ico_size / 2 + rect_height + 5)
        .attr("width", ico_size)
        .attr("height", ico_size)
        .append("xhtml:img")
        .attr("src", "../assets/slide41/eagle.ico")
        .attr("width", ico_size)
        .attr("height", ico_size)
    g_level_3.append("foreignObject")
        .attr("x", xScale_3(0.5) - rect_width / 2 + ico_size + 5)
        .attr("y", yScale(0.5) - ico_size / 2 + rect_height + 5)
        .attr("width", ico_size)
        .attr("height", ico_size)
        .append("xhtml:img")
        .attr("src", "../assets/slide41/cophy.ico")
        .attr("width", ico_size)
        .attr("height", ico_size)

    g_level_3.append("foreignObject")
        .attr("x", xScale_3(0.5) - rect_width / 2)
        .attr("y", yScale(0.25) - ico_size / 2 + rect_height + 5)
        .attr("width", ico_size)
        .attr("height", ico_size)
        .append("xhtml:img")
        .attr("src", "../assets/slide41/eagle.ico")
        .attr("width", ico_size)
        .attr("height", ico_size)
    g_level_3.append("foreignObject")
        .attr("x", xScale_3(0.5) - rect_width / 2 + ico_size + 5)
        .attr("y", yScale(0.25) - ico_size / 2 + rect_height + 5)
        .attr("width", ico_size)
        .attr("height", ico_size)
        .append("xhtml:img")
        .attr("src", "../assets/slide41/cophy.ico")
        .attr("width", ico_size)
        .attr("height", ico_size)
    g_level_3.append("foreignObject")
        .attr("x", xScale_3(0.5) - rect_width / 2 + 2*ico_size + 10)
        .attr("y", yScale(0.25) - ico_size / 2 + rect_height + 5)
        .attr("width", ico_size)
        .attr("height", ico_size)
        .append("xhtml:img")
        .attr("src", "../assets/slide41/pde.ico")
        .attr("width", ico_size)
        .attr("height", ico_size)


    g_level_3.append("foreignObject")
        .attr("x", xScale_3(0.5) - rect_width / 2)
        .attr("y", yScale(0.75) - ico_size / 2 + rect_height + 5)
        .attr("width", ico_size)
        .attr("height", ico_size)
        .append("xhtml:img")
        .attr("src", "../assets/slide41/kkl.png")
        .attr("width", ico_size)
        .attr("height", ico_size)

    g_level_3.append("foreignObject")
        .attr("x", xScale_3(0.5) - rect_width / 2 + ico_size + 5)
        .attr("y", yScale(0.75) - ico_size / 2 + rect_height + 5)
        .attr("width", ico_size)
        .attr("height", ico_size)
        .append("xhtml:img")
        .attr("src", "../assets/slide41/cdc.png")
        .attr("width", ico_size)
        .attr("height", ico_size)

    g_level_3.append("foreignObject")
        .attr("x", xScale_3(0.5) - rect_width / 2 + 2*ico_size + 10)
        .attr("y", yScale(0.75) - ico_size / 2 + rect_height + 5)
        .attr("width", ico_size)
        .attr("height", ico_size)
        .append("xhtml:img")
        .attr("src", "../assets/slide41/ifac.png")
        .attr("width", ico_size)
        .attr("height", ico_size)


    // ------------------ LEVEL 4 ------------------

    function draw_level4(x, y, text) {
        g_level_4.append("circle")
            .attr("cx", xScale_4(x))
            .attr("cy", yScale(y))
            .attr("r", radius)
            .attr("stroke", "none")
            .style("fill", "#f1a4a4")
        g_level_4.append("text")
            .attr("x", xScale_4(x) + radius * 2)
            .attr("y", yScale(y))
            .attr("text-anchor", "start")
            .attr("alignment-baseline", "middle")
            .style("fill", "#E77475")
            .style("font-size", "20px")
            .style("font-family", "sans-serif")
            .text(text);
    }

    draw_level4(0.2, 0.5, "Electromagnetism");
    draw_level4(0.2, 0.4, "Fluid Mechanics");
    draw_level4(0.2, 0.6, "...");

    draw_level4(0.2, 0.8, "+ Physics");
    draw_level4(0.2, 0.7, "+ Control");

    draw_level4(0.2, 0.99, "Robotics");
    draw_level4(0.2, 0.9, "Vision based");

    draw_level4(0.2, 0.3, "Inspired from...");
    draw_level4(0.2, 0.2, "Specific to...");

    draw_level4(0.2, 0.1, "Topological Optim.");
    draw_level4(0.2, 0.01, "Problem solving");

    // ------------------ ARROWS ------------------

    g_level_2.append("path")
        .attr("d",
            "M " + (xScale_1(0.5) + box_size / 2 + radius) + " " + yScale(0.5) +
            " C " + (xScale_1(1)) + " " + yScale(0.5) + " " + (xScale_1(1)) + " " + yScale(0.25) + " " + (xScale_2(0.5) - box_size / 2-radius) + " " + yScale(0.25))
        .attr("stroke", "#277C9D")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_2.append("path")
        .attr("d",
            "M " + (xScale_1(0.5) + box_size / 2+radius) + " " + yScale(0.5) +
            " C " + (xScale_1(1)) + " " + yScale(0.5) + " " + (xScale_1(1)) + " " + yScale(0.75) + " " + (xScale_2(0.5) - box_size / 2-radius) + " " + yScale(0.75))
        .attr("stroke", "#277C9D")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_3.append("path")
        .attr("d",
            "M " + (xScale_2(0.5) + box_size / 2+radius) + " " + yScale(0.25) +
            " C " + (xScale_2(1)) + " " + yScale(0.25) + " " + (xScale_2(1)) + " " + yScale(0.05) + " " + (xScale_3(0.5) - box_size/2 -radius) + " " + yScale(0.05))
        .attr("stroke", "#598938")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_3.append("path")
        .attr("d",
            "M " + (xScale_2(0.5) + box_size / 2+radius) + " " + yScale(0.25) +
            " C " + (xScale_2(1)) + " " + yScale(0.25) + " " + (xScale_2(1)) + " " + yScale(0.25) + " " + (xScale_3(0.5) - box_size/2 -radius) + " " + yScale(0.25))
        .attr("stroke", "#598938")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_3.append("path")
        .attr("d",
            "M " + (xScale_2(0.5) + box_size / 2+radius) + " " + yScale(0.25) +
            " C " + (xScale_2(1)) + " " + yScale(0.25) + " " + (xScale_2(1)) + " " + yScale(0.5) + " " + (xScale_3(0.5) - box_size/2 -radius) + " " + yScale(0.5))
        .attr("stroke", "#598938")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_3.append("path")
        .attr("d",
            "M " + (xScale_2(0.5) + box_size / 2+radius) + " " + yScale(0.75) +
            " C " + (xScale_2(1)) + " " + yScale(0.75) + " " + (xScale_2(1)) + " " + yScale(0.5) + " " + (xScale_3(0.5) - box_size/2 -radius) + " " + yScale(0.5))
        .attr("stroke", "#598938")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_3.append("path")
        .attr("d",
            "M " + (xScale_2(0.5) + box_size / 2+radius) + " " + yScale(0.75) +
            " C " + (xScale_2(1)) + " " + yScale(0.75) + " " + (xScale_2(1)) + " " + yScale(0.75) + " " + (xScale_3(0.5) - box_size/2 -radius) + " " + yScale(0.75))
        .attr("stroke", "#598938")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_3.append("path")
        .attr("d",
            "M " + (xScale_2(0.5) + box_size / 2+radius) + " " + yScale(0.75) +
            " C " + (xScale_2(1)) + " " + yScale(0.75) + " " + (xScale_2(1)) + " " + yScale(0.95) + " " + (xScale_3(0.5) - box_size/2 -radius) + " " + yScale(0.95))
        .attr("stroke", "#598938")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2+radius) + " " + yScale(0.05) +
            " C " + (xScale_3(1)) + " " + yScale(0.05) + " " + (xScale_3(1)) + " " + yScale(0.01) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.01))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2+radius) + " " + yScale(0.05) +
            " C " + (xScale_3(1)) + " " + yScale(0.05) + " " + (xScale_3(1)) + " " + yScale(0.1) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.1))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2+radius) + " " + yScale(0.25) +
            " C " + (xScale_3(1)) + " " + yScale(0.25) + " " + (xScale_3(1)) + " " + yScale(0.2) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.2))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2+radius) + " " + yScale(0.25) +
            " C " + (xScale_3(1)) + " " + yScale(0.25) + " " + (xScale_3(1)) + " " + yScale(0.3) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.3))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2+radius) + " " + yScale(0.5) +
            " C " + (xScale_3(1)) + " " + yScale(0.5) + " " + (xScale_3(1)) + " " + yScale(0.4) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.4))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2+radius) + " " + yScale(0.5) +
            " C " + (xScale_3(1)) + " " + yScale(0.5) + " " + (xScale_3(1)) + " " + yScale(0.5) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.5))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")


    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2+radius) + " " + yScale(0.5) +
            " C " + (xScale_3(1)) + " " + yScale(0.5) + " " + (xScale_3(1)) + " " + yScale(0.6) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.6))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2+radius) + " " + yScale(0.75) +
            " C " + (xScale_3(1)) + " " + yScale(0.75) + " " + (xScale_3(1)) + " " + yScale(0.7) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.7))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2+radius) + " " + yScale(0.75) +
            " C " + (xScale_3(1)) + " " + yScale(0.75) + " " + (xScale_3(1)) + " " + yScale(0.8) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.8))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2) + " " + yScale(0.95) +
            " C " + (xScale_3(1)) + " " + yScale(0.95) + " " + (xScale_3(1)) + " " + yScale(0.9) + " " + (xScale_4(0.2) - radius) + " " + yScale(0.9))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")

    g_level_4.append("path")
        .attr("d",
            "M " + (xScale_3(0.5) + box_size / 2) + " " + yScale(0.95) +
            " C " + (xScale_3(1)) + " " + yScale(0.95) + " " + (xScale_3(1)) + " " + yScale(1) + " " + (xScale_4(0.2) - radius) + " " + yScale(1))
        .attr("stroke", "#E77475")
        .attr("stroke-width", 3)
        .attr("fill", "none")


    g_level_2.attr("opacity", 0)
    g_level_3.attr("opacity", 0)
    g_level_4.attr("opacity", 0)

    function step1() {
        g_level_2.transition()
            .duration(250)
            .attr("opacity", 1)
        g_level_3.transition()
            .duration(250)
            .attr("opacity", 0)
        g_level_4.transition()
            .duration(250)
            .attr("opacity", 0)
    }

    function step1_reverse(){
        g_level_2.transition()
            .duration(250)
            .attr("opacity", 0)
        g_level_3.transition()
            .duration(250)
            .attr("opacity", 0)
        g_level_4.transition()
            .duration(250)
            .attr("opacity", 0)
    }

    function step2() {
        g_level_2.transition()
            .duration(250)
            .attr("opacity", 1)
        g_level_3.transition()
            .duration(250)
            .attr("opacity", 1)
        g_level_4.transition()
            .duration(250)
            .attr("opacity", 1)
    }

    function step2_reverse() {
        g_level_2.transition()
            .duration(250)
            .attr("opacity", 1)
        g_level_3.transition()
            .duration(250)
            .attr("opacity", 0)
        g_level_4.transition()
            .duration(250)
            .attr("opacity", 0)
    }

    // function step3() {
    //     g_level_2.transition()
    //         .duration(250)
    //         .attr("opacity", 1)
    //     g_level_3.transition()
    //         .duration(250)
    //         .attr("opacity", 1)
    //     g_level_4.transition()
    //         .duration(250)
    //         .attr("opacity", 1)
    // }
    //
    // function step3_reverse() {
    //     g_level_2.transition()
    //         .duration(250)
    //         .attr("opacity", 1)
    //     g_level_3.transition()
    //         .duration(250)
    //         .attr("opacity", 1)
    //     g_level_4.transition()
    //         .duration(250)
    //         .attr("opacity", 0)
    // }

    var _transitions = [
        {
            transitionForward: () => step1(),
            transitionBackward: () => step1_reverse(),
            index: 0
        },
        {
            transitionForward: () => step2(),
            transitionBackward: () => step2_reverse(),
            index: 1
        },
        // {
        //     transitionForward: () => step3(),
        //     transitionBackward: () => step3_reverse(),
        //     index: 2
        // }
    ]

</script>
</body>
</html>